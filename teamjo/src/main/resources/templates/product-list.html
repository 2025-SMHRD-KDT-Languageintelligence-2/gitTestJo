<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ìƒí’ˆ ë¦¬ìŠ¤íŠ¸</title>
  <link rel="stylesheet" href="/css/product-list.css" />
</head>
<body>
  <div class="container">
    <h2>ğŸ± ì‹ë‹¨ êµ¬ì„± ìƒí’ˆ ë¦¬ìŠ¤íŠ¸</h2>

    <!-- ğŸ” ê²€ìƒ‰ ì…ë ¥ì°½ -->
    <div class="search-bar">
      <input type="text" id="searchInput" placeholder="ìƒí’ˆëª…ì„ ì…ë ¥í•´ë³´ì„¸ìš”" />
    </div>

    <!-- ğŸ“Œ ì¹´í…Œê³ ë¦¬ íƒ­ -->
    <div class="category-tabs">
      <button class="tab-btn active" data-type="rice">ë°¥</button>
      <button class="tab-btn" data-type="soup">êµ­</button>
      <button class="tab-btn" data-type="side">ë°˜ì°¬</button>
    </div>

    <!-- ğŸ§¾ ìƒí’ˆ ë¦¬ìŠ¤íŠ¸ -->
    <div id="product-list" class="product-list">
      <div 
        th:each="food : ${foodList}" 
        class="product-card" 
        th:data-type="${food.type == 'ë°¥ë¥˜' ? 'rice' : (food.type == 'êµ­ë¥˜' ? 'soup' : 'side')}">

        <img th:src="@{${food.img}}" th:alt="${food.name}" />
        <div class="product-info">
          <strong th:text="${food.name}"></strong>
          <p th:text="'íƒ„ìˆ˜í™”ë¬¼: ' + ${food.carbo} + 'g'"></p>
          <p th:text="'ë‹¨ë°±ì§ˆ: ' + ${food.protein} + 'g'"></p>
          <p th:text="'ì§€ë°©: ' + ${food.province} + 'g'"></p>
          <a th:href="@{/detail/{id}(id=${food.foodId})}" class="detail-link">ìƒì„¸ë©”ë‰´ ë³´ê¸° &gt;</a>
        </div>
      </div>
    </div>
  </div>

  <script>
    const categoryButtons = document.querySelectorAll(".tab-btn");
    const searchInput = document.getElementById("searchInput");
    let currentCategory = "rice";

    function filterProducts() {
      const keyword = searchInput.value.toLowerCase();
      const cards = document.querySelectorAll(".product-card");

      cards.forEach(card => {
        const type = card.dataset.type;
        const name = card.querySelector("strong").textContent.toLowerCase();
        const matchType = type === currentCategory;
        const matchKeyword = name.includes(keyword);
        card.style.display = (matchType && matchKeyword) ? "block" : "none";
      });
    }

    categoryButtons.forEach(btn => {
      btn.addEventListener("click", () => {
        categoryButtons.forEach(b => b.classList.remove("active"));
        btn.classList.add("active");
        currentCategory = btn.dataset.type;
        filterProducts();
      });
    });

    searchInput.addEventListener("input", filterProducts);
    window.addEventListener("DOMContentLoaded", filterProducts);
  </script>
</body>
</html>
